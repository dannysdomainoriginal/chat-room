<!DOCTYPE html>
<html lang="en" class="h-full">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ChatCord â€” Chat Room</title>

    <!-- Tailwind v4 CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>

    <!-- Dark mode bootstrap -->
    <script>
      const theme = localStorage.getItem("theme");
      if (
        theme === "dark" ||
        (!theme && window.matchMedia("(prefers-color-scheme: dark)").matches)
      ) {
        document.documentElement.classList.add("dark");
      }
    </script>
  </head>

  <body class="h-full bg-gray-50 dark:bg-gray-950 text-gray-900 dark:text-gray-100 flex flex-col">
    <!-- Header -->
    <header class="flex items-center justify-between bg-indigo-600 dark:bg-indigo-900 text-white px-4 py-3 shadow-md">
      <h1 class="text-lg md:text-2xl font-bold flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M14.752 11.168l-3.197-2.132a1 1 0 00-1.11 0l-3.197 2.132a1 1 0 00-.447.894v4.264a1 1 0 00.447.894l3.197 2.132a1 1 0 001.11 0l3.197-2.132a1 1 0 00.447-.894v-4.264a1 1 0 00-.447-.894z" />
        </svg>
        ChatCord
      </h1>

      <div class="flex items-center gap-3">
        <!-- Theme toggle -->
        <button id="theme-toggle"
          class="inline-flex items-center justify-center rounded-lg border border-white/20 p-2 hover:bg-white/20 transition"
          aria-label="Toggle theme">
          <svg id="sun-icon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none"
            viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M12 3v2m0 14v2m9-9h-2M5 12H3m15.364-6.364l-1.414 1.414M7.05 16.95l-1.414 1.414m0-11.314L7.05 7.05m8.9 8.9l1.414 1.414M12 8a4 4 0 100 8 4 4 0 000-8z" />
          </svg>
          <svg id="moon-icon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none"
            viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z" />
          </svg>
        </button>

        <a href="/"
          class="bg-white text-indigo-600 dark:bg-gray-800 dark:text-indigo-400 px-3 py-1 rounded-lg font-medium hover:bg-white/80 dark:hover:bg-gray-700 transition">
          Leave Room
        </a>
      </div>
    </header>

    <!-- Main layout -->
    <div class="flex-1 flex overflow-hidden">
      <!-- Sidebar (off-canvas on mobile) -->
      <aside
        id="sidebar"
        class="fixed inset-y-0 left-0 z-40 w-64
               bg-gray-100 dark:bg-gray-900
               p-4 space-y-4
               border-r border-gray-200 dark:border-gray-800
               transform -translate-x-full transition-transform duration-200
               md:relative md:translate-x-0 md:flex md:flex-col">

        <div>
          <h3 class="text-sm font-semibold text-gray-500 dark:text-gray-400 flex items-center gap-1">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none"
              viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M8 10h.01M12 10h.01M16 10h.01M9 16h6M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z" />
            </svg>
            Room Name
          </h3>
          <h2 id="room-name" class="text-xl font-bold mt-1"></h2>
        </div>

        <div>
          <h3 class="text-sm font-semibold text-gray-500 dark:text-gray-400 flex items-center gap-1 mb-1">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none"
              viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M17 20h5v-2a4 4 0 00-4-4h-1M9 20H4v-2a4 4 0 014-4h1M12 12a4 4 0 100-8 4 4 0 000 8z" />
            </svg>
            Users
          </h3>
          <ul id="users" class="list-disc list-inside text-gray-700 dark:text-gray-300"></ul>
        </div>
      </aside>

      <!-- Chat area -->
      <main class="flex-1 flex flex-col bg-white dark:bg-gray-950">
        <div class="flex-1 overflow-y-auto p-4 space-y-4 chat-messages"></div>

        <!-- Sticky input -->
        <div class="sticky bottom-0 bg-gray-200 dark:bg-gray-900 p-4 border-t border-gray-300 dark:border-gray-800">
          <form id="chat-form" class="flex gap-2">
            <input id="msg" type="text" required autocomplete="off"
              placeholder="Enter message"
              class="flex-1 rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-950 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
            <button type="submit"
              class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-medium transition">
              Send
            </button>
          </form>
        </div>
      </main>
    </div>

    <!-- Theme toggle logic -->
    <script>
      const html = document.documentElement;
      const toggleBtn = document.getElementById("theme-toggle");
      const sunIcon = document.getElementById("sun-icon");
      const moonIcon = document.getElementById("moon-icon");

      function syncIcons() {
        const isDark = html.classList.contains("dark");
        sunIcon.style.display = isDark ? "block" : "none";
        moonIcon.style.display = isDark ? "none" : "block";
      }

      toggleBtn.addEventListener("click", () => {
        html.classList.toggle("dark");
        localStorage.setItem("theme", html.classList.contains("dark") ? "dark" : "light");
        syncIcons();
      });

      syncIcons();
    </script>

    <!-- App logic -->
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>